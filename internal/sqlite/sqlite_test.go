package sqlite

import (
	"database/sql"
	"encoding/hex"
	"github.com/Layr-Labs/go-sidecar/internal/logger"
	"github.com/Layr-Labs/go-sidecar/internal/tests"
	"github.com/Layr-Labs/go-sidecar/internal/types/numbers"
	"github.com/shopspring/decimal"
	"github.com/stretchr/testify/assert"
	"math/big"
	"strings"
	"testing"
)

func Test_Sqlite(t *testing.T) {
	l, _ := logger.NewLogger(&logger.LoggerConfig{Debug: true})

	t.Run("Should use the bytesToHex function", func(t *testing.T) {
		query := `
			with json_values as (
				select 
					cast('{"newWithdrawalRoot": [218, 200, 138, 86, 38, 9, 156, 119, 73, 13, 168, 40, 209, 43, 238, 83, 234, 177, 230, 73, 120, 205, 255, 143, 255, 216, 51, 209, 137, 100, 163, 233] }' as text) as json_col
				from (select 1)
			)
			select
				bytes_to_hex(json_extract(json_col, '$.newWithdrawalRoot')) AS withdrawal_hex
			from json_values
			limit 1
		`
		s := NewSqlite(&SqliteConfig{
			Path:           SqliteInMemoryPath,
			ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
		}, l)
		grm, err := NewGormSqliteFromSqlite(s)
		assert.Nil(t, err)

		type results struct {
			WithdrawalHex string
		}

		hexValue := &results{}
		res := grm.Raw(query).Scan(&hexValue)

		expectedBytes := []byte{218, 200, 138, 86, 38, 9, 156, 119, 73, 13, 168, 40, 209, 43, 238, 83, 234, 177, 230, 73, 120, 205, 255, 143, 255, 216, 51, 209, 137, 100, 163, 233}

		assert.Nil(t, res.Error)
		assert.Equal(t, strings.ToLower(hex.EncodeToString(expectedBytes)), hexValue.WithdrawalHex)
	})
	t.Run("Should sum two really big numbers that are stored as strings", func(t *testing.T) {
		shares1 := "1670000000000000000000"
		shares2 := "1670000000000000000000"

		type shares struct {
			Shares string
		}

		operatorShares := []*shares{
			&shares{
				Shares: shares1,
			},
			&shares{
				Shares: shares2,
			},
		}

		s := NewSqlite(&SqliteConfig{
			Path:           SqliteInMemoryPath,
			ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
		}, l)
		grm, err := NewGormSqliteFromSqlite(s)
		assert.Nil(t, err)

		createQuery := `
			create table shares (
				shares TEXT NOT NULL
			)
		`
		res := grm.Exec(createQuery)
		assert.Nil(t, res.Error)

		res = grm.Model(&shares{}).Create(&operatorShares)
		assert.Nil(t, res.Error)

		query := `
			select
				sum_big(shares) as total
			from shares
		`
		var total string
		res = grm.Raw(query).Scan(&total)
		assert.Nil(t, res.Error)

		shares1Big, _ := new(big.Int).SetString(shares1, 10)
		shares2Big, _ := new(big.Int).SetString(shares2, 10)

		expectedTotal := shares1Big.Add(shares1Big, shares2Big)

		assert.Equal(t, expectedTotal.String(), total)
	})
	t.Run("Custom Go functions", func(t *testing.T) {
		t.Run("Should call calc_raw_tokens_per_day", func(t *testing.T) {
			query := `select calc_raw_tokens_per_day('100', 100) as amt`

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			var result string
			res := grm.Raw(query).Scan(&result)
			assert.Nil(t, res.Error)

			assert.Equal(t, "86400.0000000000080179", result)

		})
	})
	t.Run("Custom C functions", func(t *testing.T) {
		t.Run("Should call pre_nile_tokens_per_day", func(t *testing.T) {
			expectedRoundedValue := "1428571428571427000000000000000000000"

			amount := "1428571428571428571428571428571428571.4142857142857143"

			query := `select pre_nile_tokens_per_day(@amount) as amt`

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			var result string
			res := grm.Raw(query, sql.Named("amount", amount)).Scan(&result)
			assert.Nil(t, res.Error)

			assert.Equal(t, expectedRoundedValue, result)

		})
		t.Run("Should call amazon_staker_token_rewards", func(t *testing.T) {
			values := [][]string{
				[]string{"0.000000233633089000000000", "7.142857142857135e+22", "16688077785714300", "amazon"},
				[]string{"0.000000177537586000000000", "7.142857142857135e+22", "12681256142857100", "amazon"},
				[]string{"0.000000177514794000000000", "7.142857142857135e+22", "12679628142857100", "amazon"},
				[]string{"0.000003372787644000000000", "7.142857142857135e+22", "240913403142857000", "amazon"},
				[]string{"0.000021304136626000000000", "7.142857142857135e+22", "1521724044714280000", "amazon"},
				[]string{"0.000003551067093000000000", "7.142857142857135e+22", "253647649500000000", "amazon"},
				[]string{"0.000000887858008000000000", "7.142857142857135e+22", "63418429142857100", "amazon"},
				[]string{"0.000000012661914000000000", "7.142857142857135e+22", "904422428571428", "amazon"},
				[]string{"0.000002482654495000000000", "7.142857142857135e+22", "177332463928571000", "amazon"},
				[]string{"0.000001775512533000000000", "7.142857142857135e+22", "126822323785714000", "amazon"},
				[]string{"0.000001775756120000000000", "7.142857142857135e+22", "126839722857143000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000002299906492000000000", "7.142857142857135e+22", "164279035142857000", "amazon"},
				[]string{"0.000001597700606000000000", "7.142857142857135e+22", "114121471857143000", "amazon"},
				[]string{"0.000000359786555000000000", "7.142857142857135e+22", "25699039642857100", "amazon"},
				[]string{"0.000000177567222000000000", "7.142857142857135e+22", "12683373000000000", "amazon"},
				[]string{"0.000000355076582000000000", "7.142857142857135e+22", "25362613000000000", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000000177578367000000000", "7.142857142857135e+22", "12684169071428600", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000000017757362000000000", "7.142857142857135e+22", "1268383000000000", "amazon"},
				[]string{"0.000000177558152000000000", "7.142857142857135e+22", "12682725142857100", "amazon"},
				[]string{"0.000001931634760000000000", "7.142857142857135e+22", "137973911428571000", "amazon"},
				[]string{"0.000000040834548000000000", "7.142857142857135e+22", "2916753428571430", "amazon"},
				[]string{"0.000000710105925000000000", "7.142857142857135e+22", "50721851785714200", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000000038350448000000000", "7.142857142857135e+22", "2739317714285710", "amazon"},
				[]string{"0.000000355121463000000000", "7.142857142857135e+22", "25365818785714300", "amazon"},
				[]string{"0.000000177554058000000000", "7.142857142857135e+22", "12682432714285700", "amazon"},
				[]string{"0.000000301861695000000000", "7.142857142857135e+22", "21561549642857100", "amazon"},
				[]string{"0.000004108354053000000000", "7.142857142857135e+22", "293453860928571000", "amazon"},
				[]string{"0.000000355168101000000000", "7.142857142857135e+22", "25369150071428500", "amazon"},
				[]string{"0.000000172215965000000000", "7.142857142857135e+22", "12301140357142800", "amazon"},
				[]string{"0.000001597809657000000000", "7.142857142857135e+22", "114129261214286000", "amazon"},
				[]string{"0.000000177550592000000000", "7.142857142857135e+22", "12682185142857100", "amazon"},
				[]string{"0.000002663598360000000000", "7.142857142857135e+22", "190257025714286000", "amazon"},
				[]string{"0.0000000024857170000000000000", "7.142857142857135e+22", "177551214285714", "amazon"},
				[]string{"0.000001775326494000000000", "7.142857142857135e+22", "126809035285714000", "amazon"},
				[]string{"0.000000159778491000000000", "7.142857142857135e+22", "11412749357142800", "amazon"},
				[]string{"0.000002663133481000000000", "7.142857142857135e+22", "190223820071428000", "amazon"},
				[]string{"0.000000035508446000000000", "7.142857142857135e+22", "2536317571428570", "amazon"},
				[]string{"0.000000177548374000000000", "7.142857142857135e+22", "12682026714285700", "amazon"},
				[]string{"0.000000088748380000000000", "7.142857142857135e+22", "6339169999999990", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000007100891583000000000", "7.142857142857135e+22", "507206541642857000", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000004616540484000000000", "7.142857142857135e+22", "329752891714285000", "amazon"},
				[]string{"0.000000185021493000000000", "7.142857142857135e+22", "13215820928571400", "amazon"},
				[]string{"0.000000177548727000000000", "7.142857142857135e+22", "12682051928571400", "amazon"},
				[]string{"0.000000355081543000000000", "7.142857142857135e+22", "25362967357142800", "amazon"},
				[]string{"0.000002663074368000000000", "7.142857142857135e+22", "190219597714286000", "amazon"},
				[]string{"0.000000177536883000000000", "7.142857142857135e+22", "12681205928571400", "amazon"},
				[]string{"0.000000060373913000000000", "7.142857142857135e+22", "4312422357142850", "amazon"},
				[]string{"0.000000048178271000000000", "7.142857142857135e+22", "3441305071428570", "amazon"},
				[]string{"0.000000887868103000000000", "7.142857142857135e+22", "63419150214285600", "amazon"},
				[]string{"0.000000177459537000000000", "7.142857142857135e+22", "12675681214285700", "amazon"},
				[]string{"0.000001597844621000000000", "7.142857142857135e+22", "114131758642857000", "amazon"},
				[]string{"0.000000177547181000000000", "7.142857142857135e+22", "12681941500000000", "amazon"},
				[]string{"0.000000017757322000000000", "7.142857142857135e+22", "1268380142857140", "amazon"},
				[]string{"0.000000357213530000000000", "7.142857142857135e+22", "25515252142857100", "amazon"},
				[]string{"0.0000000071016140000000000000", "7.142857142857135e+22", "507258142857142", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000000017757404000000000", "7.142857142857135e+22", "1268386000000000", "amazon"},
				[]string{"0.000000159802036000000000", "7.142857142857135e+22", "11414431142857100", "amazon"},
				[]string{"0.000000026986073000000000", "7.142857142857135e+22", "1927576642857140", "amazon"},
				[]string{"0.000000390680929000000000", "7.142857142857135e+22", "27905780642857100", "amazon"},
				[]string{"0.000000120749278000000000", "7.142857142857135e+22", "8624948428571420", "amazon"},
				[]string{"0.000000468740856000000000", "7.142857142857135e+22", "33481489714285700", "amazon"},
				[]string{"0.000000710224567000000000", "7.142857142857135e+22", "50730326214285700", "amazon"},
				[]string{"0.000000177564599000000000", "7.142857142857135e+22", "12683185642857100", "amazon"},
				[]string{"0.000000887673997000000000", "7.142857142857135e+22", "63405285499999900", "amazon"},
				[]string{"0.000001775411165000000000", "7.142857142857135e+22", "126815083214286000", "amazon"},
				[]string{"0.000000177548374000000000", "7.142857142857135e+22", "12682026714285700", "amazon"},
				[]string{"0.000000177539258000000000", "7.142857142857135e+22", "12681375571428600", "amazon"},
				[]string{"0.000000355105445000000000", "7.142857142857135e+22", "25364674642857100", "amazon"},
				[]string{"0.000000177580851000000000", "7.142857142857135e+22", "12684346500000000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000000353305315000000000", "7.142857142857135e+22", "25236093928571400", "amazon"},
				[]string{"0.000000177541515000000000", "7.142857142857135e+22", "12681536785714300", "amazon"},
				[]string{"0.000000976531893000000000", "7.142857142857135e+22", "69752278071428500", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000000088773423000000000", "7.142857142857135e+22", "6340958785714280", "amazon"},
				[]string{"0.000000195292120000000000", "7.142857142857135e+22", "13949437142857100", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000001775389231000000000", "7.142857142857135e+22", "126813516500000000", "amazon"},
				[]string{"0.000001598140265000000000", "7.142857142857135e+22", "114152876071428000", "amazon"},
				[]string{"0.000000710284562000000000", "7.142857142857135e+22", "50734611571428500", "amazon"},
				[]string{"0.000002303147080000000000", "7.142857142857135e+22", "164510505714286000", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000005681151339000000000", "7.142857142857135e+22", "405796524214285000", "amazon"},
				[]string{"0.000000355104750000000000", "7.142857142857135e+22", "25364625000000000", "amazon"},
				[]string{"0.000001775660792000000000", "7.142857142857135e+22", "126832913714286000", "amazon"},
				[]string{"0.000000177560352000000000", "7.142857142857135e+22", "12682882285714300", "amazon"},
				[]string{"0.000000177556141000000000", "7.142857142857135e+22", "12682581500000000", "amazon"},
				[]string{"0.0000000088773420000000000000", "7.142857142857135e+22", "634095857142856", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000000532640539000000000", "7.142857142857135e+22", "38045752785714200", "amazon"},
				[]string{"0.000000017757201000000000", "7.142857142857135e+22", "1268371500000000", "amazon"},
				[]string{"0.000007808392428000000000", "7.142857142857135e+22", "557742316285714000", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000002840189801000000000", "7.142857142857135e+22", "202870700071428000", "amazon"},
				[]string{"0.000000195322687000000000", "7.142857142857135e+22", "13951620500000000", "amazon"},
				[]string{"0.000003551103538000000000", "7.142857142857135e+22", "253650252714285000", "amazon"},
				[]string{"0.000000204202306000000000", "7.142857142857135e+22", "14585879000000000", "amazon"},
				[]string{"0.000001775107959000000000", "7.142857142857135e+22", "126793425642857000", "amazon"},
				[]string{"0.000001775626855000000000", "7.142857142857135e+22", "126830489642857000", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000000177563476000000000", "7.142857142857135e+22", "12683105428571400", "amazon"},
				[]string{"0.000013096832711000000000", "7.142857142857135e+22", "935488050785713000", "amazon"},
				[]string{"0.000017762711625000000000", "7.142857142857135e+22", "1268765116071430000", "amazon"},
				[]string{"0.0000000001775340000000000000", "7.142857142857135e+22", "12681000000000", "amazon"},
				[]string{"0.000000182990504000000000", "7.142857142857135e+22", "13070750285714300", "amazon"},
				[]string{"0.000000355117737000000000", "7.142857142857135e+22", "25365552642857100", "amazon"},
				[]string{"0.000000017757404000000000", "7.142857142857135e+22", "1268386000000000", "amazon"},
				[]string{"0.000000710159838000000000", "7.142857142857135e+22", "50725702714285700", "amazon"},
				[]string{"0.000000177554458000000000", "7.142857142857135e+22", "12682461285714300", "amazon"},
				[]string{"0.000001589907669000000000", "7.142857142857135e+22", "113564833500000000", "amazon"},
				[]string{"0.000000177543335000000000", "7.142857142857135e+22", "12681666785714300", "amazon"},
				[]string{"0.000000075071005000000000", "7.142857142857135e+22", "5362214642857140", "amazon"},
				[]string{"0.000001420319676000000000", "7.142857142857135e+22", "101451405428571000", "amazon"},
				[]string{"0.000002982066649000000000", "7.142857142857135e+22", "213004760642857000", "amazon"},
				[]string{"0.000000710159838000000000", "7.142857142857135e+22", "50725702714285700", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000000177573620000000000", "7.142857142857135e+22", "12683830000000000", "amazon"},
				[]string{"0.000000177574483000000000", "7.142857142857135e+22", "12683891642857100", "amazon"},
				[]string{"0.000000012072646000000000", "7.142857142857135e+22", "862331857142856", "amazon"},
				[]string{"0.000001104189940000000000", "7.142857142857135e+22", "78870709999999900", "amazon"},
				[]string{"0.000000143831267000000000", "7.142857142857135e+22", "10273661928571400", "amazon"},
				[]string{"0.000001775748592000000000", "7.142857142857135e+22", "126839185142857000", "amazon"},
				[]string{"0.000000060374187000000000", "7.142857142857135e+22", "4312441928571420", "amazon"},
				[]string{"0.0000000035510170000000000000", "7.142857142857135e+22", "253644071428571", "amazon"},
				[]string{"0.000000177564599000000000", "7.142857142857135e+22", "12683185642857100", "amazon"},
				[]string{"0.000000355161702000000000", "7.142857142857135e+22", "25368693000000000", "amazon"},
				[]string{"0.000000213064870000000000", "7.142857142857135e+22", "15218919285714300", "amazon"},
				[]string{"0.000000390677872000000000", "7.142857142857135e+22", "27905562285714300", "amazon"},
				[]string{"0.000000177554458000000000", "7.142857142857135e+22", "12682461285714300", "amazon"},
				[]string{"0.000002396341602000000000", "7.142857142857135e+22", "171167257285714000", "amazon"},
				[]string{"0.000000408349671000000000", "7.142857142857135e+22", "29167833642857100", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000003551199595000000000", "7.142857142857135e+22", "253657113928571000", "amazon"},
				[]string{"0.000000017757404000000000", "7.142857142857135e+22", "1268386000000000", "amazon"},
				[]string{"0.000000177564599000000000", "7.142857142857135e+22", "12683185642857100", "amazon"},
				[]string{"0.000000230836358000000000", "7.142857142857135e+22", "16488311285714300", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000000314294607000000000", "7.142857142857135e+22", "22449614785714300", "amazon"},
				[]string{"0.000000026630993000000000", "7.142857142857135e+22", "1902213785714280", "amazon"},
				[]string{"0.000003729209146000000000", "7.142857142857135e+22", "266372081857143000", "amazon"},
				[]string{"0.000000142042965000000000", "7.142857142857135e+22", "10145926071428600", "amazon"},
				[]string{"0.000000355124667000000000", "7.142857142857135e+22", "25366047642857100", "amazon"},
				[]string{"0.01808510817074100000", "7.142857142857135e+22", "1291793440767210000000", "amazon"},
				[]string{"0.000000266348554000000000", "7.142857142857135e+22", "19024896714285700", "amazon"},
				[]string{"0.000005326288078000000000", "7.142857142857135e+22", "380449148428571000", "amazon"},
				[]string{"0.000000177532649000000000", "7.142857142857135e+22", "12680903500000000", "amazon"},
				[]string{"0.000000017757448000000000", "7.142857142857135e+22", "1268389142857140", "amazon"},
				[]string{"0.000000177423764000000000", "7.142857142857135e+22", "12673126000000000", "amazon"},
				[]string{"0.000000178116271000000000", "7.142857142857135e+22", "12722590785714300", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000000177551253000000000", "7.142857142857135e+22", "12682232357142800", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000001065237499000000000", "7.142857142857135e+22", "76088392785714200", "amazon"},
				[]string{"0.000000177559979000000000", "7.142857142857135e+22", "12682855642857100", "amazon"},
				[]string{"0.000009111744211000000000", "7.142857142857135e+22", "650838872214285000", "amazon"},
				[]string{"0.000003551253711000000000", "7.142857142857135e+22", "253660979357143000", "amazon"},
				[]string{"0.000000355132858000000000", "7.142857142857135e+22", "25366632714285700", "amazon"},
				[]string{"0.000000887761875000000000", "7.142857142857135e+22", "63411562499999900", "amazon"},
				[]string{"0.000000200838258000000000", "7.142857142857135e+22", "14345589857142800", "amazon"},
				[]string{"0.000000017757246000000000", "7.142857142857135e+22", "1268374714285710", "amazon"},
				[]string{"0.000001597866946000000000", "7.142857142857135e+22", "114133353285714000", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000002663047853000000000", "7.142857142857135e+22", "190217703785714000", "amazon"},
				[]string{"0.000000177572838000000000", "7.142857142857135e+22", "12683774142857100", "amazon"},
				[]string{"0.000001686709560000000000", "7.142857142857135e+22", "120479254285714000", "amazon"},
				[]string{"0.000000177554058000000000", "7.142857142857135e+22", "12682432714285700", "amazon"},
				[]string{"0.000000177551253000000000", "7.142857142857135e+22", "12682232357142800", "amazon"},
				[]string{"0.000002225000472000000000", "7.142857142857135e+22", "158928605142857000", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000008666327209000000000", "7.142857142857135e+22", "619023372071428000", "amazon"},
				[]string{"0.000000423625718000000000", "7.142857142857135e+22", "30258979857142800", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000000177538923000000000", "7.142857142857135e+22", "12681351642857100", "amazon"},
				[]string{"0.000002130765817000000000", "7.142857142857135e+22", "152197558357143000", "amazon"},
				[]string{"0.000000603676804000000000", "7.142857142857135e+22", "43119771714285700", "amazon"},
				[]string{"0.000017763531887000000000", "7.142857142857135e+22", "1268823706214280000", "amazon"},
				[]string{"0.000004437777571000000000", "7.142857142857135e+22", "316984112214285000", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000000887737251000000000", "7.142857142857135e+22", "63409803642857100", "amazon"},
				[]string{"0.000000035516001000000000", "7.142857142857135e+22", "2536857214285710", "amazon"},
				[]string{"0.000001104411788000000000", "7.142857142857135e+22", "78886556285714200", "amazon"},
				[]string{"0.000002662704928000000000", "7.142857142857135e+22", "190193209142857000", "amazon"},
				[]string{"0.000000532575061000000000", "7.142857142857135e+22", "38041075785714200", "amazon"},
				[]string{"0.000000177564599000000000", "7.142857142857135e+22", "12683185642857100", "amazon"},
				[]string{"0.000001952921203000000000", "7.142857142857135e+22", "139494371642857000", "amazon"},
				[]string{"0.000000870146170000000000", "7.142857142857135e+22", "62153297857142800", "amazon"},
				[]string{"0.000001775808511000000000", "7.142857142857135e+22", "126843465071428000", "amazon"},
				[]string{"0.000000177556141000000000", "7.142857142857135e+22", "12682581500000000", "amazon"},
				[]string{"0.0000000042609340000000000000", "7.142857142857135e+22", "304352428571428", "amazon"},
				[]string{"0.000000930527667000000000", "7.142857142857135e+22", "66466261928571400", "amazon"},
				[]string{"0.000000187180797000000000", "7.142857142857135e+22", "13370056928571400", "amazon"},
				[]string{"0.000003551627758000000000", "7.142857142857135e+22", "253687697000000000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000003549401782000000000", "7.142857142857135e+22", "253528698714285000", "amazon"},
				[]string{"0.000000319640281000000000", "7.142857142857135e+22", "22831448642857100", "amazon"},
				[]string{"0.000000017757404000000000", "7.142857142857135e+22", "1268386000000000", "amazon"},
				[]string{"0.000000887858008000000000", "7.142857142857135e+22", "63418429142857100", "amazon"},
				[]string{"0.000001563512861000000000", "7.142857142857135e+22", "111679490071428000", "amazon"},
				[]string{"0.000000372859202000000000", "7.142857142857135e+22", "26632800142857100", "amazon"},
				[]string{"0.000001266575990000000000", "7.142857142857135e+22", "90469713571428500", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000002466061603000000000", "7.142857142857135e+22", "176147257357143000", "amazon"},
				[]string{"0.000000010652810000000000", "7.142857142857135e+22", "760914999999999", "amazon"},
				[]string{"0.000001775392583000000000", "7.142857142857135e+22", "126813755928571000", "amazon"},
				[]string{"0.000000177553706000000000", "7.142857142857135e+22", "12682407571428600", "amazon"},
				[]string{"0.000003373987847000000000", "7.142857142857135e+22", "240999131928571000", "amazon"},
				[]string{"0.000000355145676000000000", "7.142857142857135e+22", "25367548285714300", "amazon"},
				[]string{"0.000000177547732000000000", "7.142857142857135e+22", "12681980857142800", "amazon"},
				[]string{"0.000001775392583000000000", "7.142857142857135e+22", "126813755928571000", "amazon"},
				[]string{"0.000001988244646000000000", "7.142857142857135e+22", "142017474714286000", "amazon"},
				[]string{"0.000000284080374000000000", "7.142857142857135e+22", "20291455285714300", "amazon"},
				[]string{"0.000000088773423000000000", "7.142857142857135e+22", "6340958785714280", "amazon"},
				[]string{"0.000000012412689000000000", "7.142857142857135e+22", "886620642857142", "amazon"},
				[]string{"0.000000015626619000000000", "7.142857142857135e+22", "1116187071428570", "amazon"},
				[]string{"0.000000177540359000000000", "7.142857142857135e+22", "12681454214285700", "amazon"},
				[]string{"0.000001596302109000000000", "7.142857142857135e+22", "114021579214286000", "amazon"},
				[]string{"0.000004438764810000000000", "7.142857142857135e+22", "317054629285714000", "amazon"},
				[]string{"0.000002343500688000000000", "7.142857142857135e+22", "167392906285714000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000015980145879000000000", "7.142857142857135e+22", "1141438991357140000", "amazon"},
				[]string{"0.000000558681465000000000", "7.142857142857135e+22", "39905818928571400", "amazon"},
				[]string{"0.000000044385089000000000", "7.142857142857135e+22", "3170363500000000", "amazon"},
				[]string{"0.000000177574483000000000", "7.142857142857135e+22", "12683891642857100", "amazon"},
				[]string{"0.000000532640539000000000", "7.142857142857135e+22", "38045752785714200", "amazon"},
				[]string{"0.000001775779343000000000", "7.142857142857135e+22", "126841381642857000", "amazon"},
				[]string{"0.000000372833124000000000", "7.142857142857135e+22", "26630937428571400", "amazon"},
				[]string{"0.000000887734232000000000", "7.142857142857135e+22", "63409587999999900", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000000355103192000000000", "7.142857142857135e+22", "25364513714285700", "amazon"},
				[]string{"0.000000088785800000000000", "7.142857142857135e+22", "6341842857142850", "amazon"},
				[]string{"0.000000088774187000000000", "7.142857142857135e+22", "6341013357142850", "amazon"},
				[]string{"0.000000710213418000000000", "7.142857142857135e+22", "50729529857142800", "amazon"},
				[]string{"0.000000177573620000000000", "7.142857142857135e+22", "12683830000000000", "amazon"},
				[]string{"0.000003551228961000000000", "7.142857142857135e+22", "253659211500000000", "amazon"},
				[]string{"0.000000086990994000000000", "7.142857142857135e+22", "6213642428571420", "amazon"},
				[]string{"0.000000177550592000000000", "7.142857142857135e+22", "12682185142857100", "amazon"},
				[]string{"0.000000177550884000000000", "7.142857142857135e+22", "12682206000000000", "amazon"},
				[]string{"0.000001242667891000000000", "7.142857142857135e+22", "88761992214285600", "amazon"},
				[]string{"0.000021292591828000000000", "7.142857142857135e+22", "1520899416285710000", "amazon"},
				[]string{"0.000000621503638000000000", "7.142857142857135e+22", "44393117000000000", "amazon"},
				[]string{"0.0000000009232450000000000000", "7.142857142857135e+22", "65946071428571", "amazon"},
				[]string{"0.000000177561448000000000", "7.142857142857135e+22", "12682960571428600", "amazon"},
				[]string{"0.000000014203747000000000", "7.142857142857135e+22", "1014553357142860", "amazon"},
				[]string{"0.000000071026734000000000", "7.142857142857135e+22", "5073338142857140", "amazon"},
				[]string{"0.000000355127636000000000", "7.142857142857135e+22", "25366259714285700", "amazon"},
				[]string{"0.0000000010579920000000000000", "7.142857142857135e+22", "75570857142857", "amazon"},
				[]string{"0.000000031608179000000000", "7.142857142857135e+22", "2257727071428570", "amazon"},
				[]string{"0.000000019529522000000000", "7.142857142857135e+22", "1394965857142860", "amazon"},
				[]string{"0.000000175771378000000000", "7.142857142857135e+22", "12555098428571400", "amazon"},
				[]string{"0.000000781166896000000000", "7.142857142857135e+22", "55797635428571400", "amazon"},
				[]string{"0.000000240392182000000000", "7.142857142857135e+22", "17170870142857100", "amazon"},
				[]string{"0.000000355077174000000000", "7.142857142857135e+22", "25362655285714300", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000000142042965000000000", "7.142857142857135e+22", "10145926071428600", "amazon"},
				[]string{"0.000001775840505000000000", "7.142857142857135e+22", "126845750357143000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000001597584141000000000", "7.142857142857135e+22", "114113152928571000", "amazon"},
				[]string{"0.000000282354209000000000", "7.142857142857135e+22", "20168157785714300", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000003551662131000000000", "7.142857142857135e+22", "253690152214285000", "amazon"},
				[]string{"0.000003729241184000000000", "7.142857142857135e+22", "266374370285714000", "amazon"},
				[]string{"0.000000177566429000000000", "7.142857142857135e+22", "12683316357142800", "amazon"},
				[]string{"0.000000177548727000000000", "7.142857142857135e+22", "12682051928571400", "amazon"},
				[]string{"0.000000177533694000000000", "7.142857142857135e+22", "12680978142857100", "amazon"},
				[]string{"0.000000129625854000000000", "7.142857142857135e+22", "9258989571428560", "amazon"},
				[]string{"0.000003550134028000000000", "7.142857142857135e+22", "253581002000000000", "amazon"},
				[]string{"0.000000177532649000000000", "7.142857142857135e+22", "12680903500000000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000000372870787000000000", "7.142857142857135e+22", "26633627642857100", "amazon"},
				[]string{"0.000000017755997000000000", "7.142857142857135e+22", "1268285500000000", "amazon"},
				[]string{"0.000007422200278000000000", "7.142857142857135e+22", "530157162714285000", "amazon"},
				[]string{"0.000002662673080000000000", "7.142857142857135e+22", "190190934285714000", "amazon"},
				[]string{"0.000000177540771000000000", "7.142857142857135e+22", "12681483642857100", "amazon"},
				[]string{"0.000000012426728000000000", "7.142857142857135e+22", "887623428571428", "amazon"},
				[]string{"0.000000177551596000000000", "7.142857142857135e+22", "12682256857142800", "amazon"},
				[]string{"0.000006907963857000000000", "7.142857142857135e+22", "493425989785714000", "amazon"},
				[]string{"0.000001846065634000000000", "7.142857142857135e+22", "131861831000000000", "amazon"},
				[]string{"0.000000177554816000000000", "7.142857142857135e+22", "12682486857142800", "amazon"},
				[]string{"0.000000177571601000000000", "7.142857142857135e+22", "12683685785714300", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000000887675705000000000", "7.142857142857135e+22", "63405407499999900", "amazon"},
				[]string{"0.000001604331294000000000", "7.142857142857135e+22", "114595092428571000", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000000887897984000000000", "7.142857142857135e+22", "63421284571428500", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000000017755445000000000", "7.142857142857135e+22", "1268246071428570", "amazon"},
				[]string{"0.000000355108917000000000", "7.142857142857135e+22", "25364922642857100", "amazon"},
				[]string{"0.000002450032506000000000", "7.142857142857135e+22", "175002321857143000", "amazon"},
				[]string{"0.000001597684809000000000", "7.142857142857135e+22", "114120343500000000", "amazon"},
				[]string{"0.000002837879536000000000", "7.142857142857135e+22", "202705681142857000", "amazon"},
				[]string{"0.000000177563476000000000", "7.142857142857135e+22", "12683105428571400", "amazon"},
				[]string{"0.000000177563052000000000", "7.142857142857135e+22", "12683075142857100", "amazon"},
				[]string{"0.000000177539959000000000", "7.142857142857135e+22", "12681425642857100", "amazon"},
				[]string{"0.000000365731541000000000", "7.142857142857135e+22", "26123681500000000", "amazon"},
				[]string{"0.000000023515468000000000", "7.142857142857135e+22", "1679676285714280", "amazon"},
				[]string{"0.000000017757448000000000", "7.142857142857135e+22", "1268389142857140", "amazon"},
				[]string{"0.000000013492958000000000", "7.142857142857135e+22", "963782714285713", "amazon"},
				[]string{"0.000000728058411000000000", "7.142857142857135e+22", "52004172214285700", "amazon"},
				[]string{"0.000001775208995000000000", "7.142857142857135e+22", "126800642500000000", "amazon"},
				[]string{"0.000000177550884000000000", "7.142857142857135e+22", "12682206000000000", "amazon"},
				[]string{"0.000001775817698000000000", "7.142857142857135e+22", "126844121285714000", "amazon"},
				[]string{"0.000000779559191000000000", "7.142857142857135e+22", "55682799357142800", "amazon"},
				[]string{"0.000000887431836000000000", "7.142857142857135e+22", "63387988285714200", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000000550470535000000000", "7.142857142857135e+22", "39319323928571400", "amazon"},
				[]string{"0.000005504709613000000000", "7.142857142857135e+22", "393193543785714000", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000000177564194000000000", "7.142857142857135e+22", "12683156714285700", "amazon"},
				[]string{"0.000000266306379000000000", "7.142857142857135e+22", "19021884214285700", "amazon"},
				[]string{"0.000000198927557000000000", "7.142857142857135e+22", "14209111214285700", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.0000000095875290000000000000", "7.142857142857135e+22", "684823499999999", "amazon"},
				[]string{"0.000004439095452000000000", "7.142857142857135e+22", "317078246571428000", "amazon"},
				[]string{"0.000000887672031000000000", "7.142857142857135e+22", "63405145071428500", "amazon"},
				[]string{"0.000000124306595000000000", "7.142857142857135e+22", "8879042499999990", "amazon"},
				[]string{"0.000000177561448000000000", "7.142857142857135e+22", "12682960571428600", "amazon"},
				[]string{"0.000000177556141000000000", "7.142857142857135e+22", "12682581500000000", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000000887692937000000000", "7.142857142857135e+22", "63406638357142800", "amazon"},
				[]string{"0.000001864372118000000000", "7.142857142857135e+22", "133169437000000000", "amazon"},
				[]string{"0.000000177557176000000000", "7.142857142857135e+22", "12682655428571400", "amazon"},
				[]string{"0.000001597787552000000000", "7.142857142857135e+22", "114127682285714000", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000003551017690000000000", "7.142857142857135e+22", "253644120714285000", "amazon"},
				[]string{"0.000000177555176000000000", "7.142857142857135e+22", "12682512571428600", "amazon"},
				[]string{"0.000000165320889000000000", "7.142857142857135e+22", "11808634928571400", "amazon"},
				[]string{"0.000000177550592000000000", "7.142857142857135e+22", "12682185142857100", "amazon"},
				[]string{"0.000000010297257000000000", "7.142857142857135e+22", "735518357142856", "amazon"},
				[]string{"0.000000177548374000000000", "7.142857142857135e+22", "12682026714285700", "amazon"},
				[]string{"0.0000000002130710000000000000", "7.142857142857135e+22", "15219357142857", "amazon"},
				[]string{"0.000002663202697000000000", "7.142857142857135e+22", "190228764071428000", "amazon"},
				[]string{"0.000004438851461000000000", "7.142857142857135e+22", "317060818642857000", "amazon"},
				[]string{"0.000000239690305000000000", "7.142857142857135e+22", "17120736071428600", "amazon"},
				[]string{"0.000000216681417000000000", "7.142857142857135e+22", "15477244071428600", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000000195117308000000000", "7.142857142857135e+22", "13936950571428600", "amazon"},
				[]string{"0.000001757383689000000000", "7.142857142857135e+22", "125527406357143000", "amazon"},
				[]string{"0.000002166071527000000000", "7.142857142857135e+22", "154719394785714000", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000008621576383000000000", "7.142857142857135e+22", "615826884499999000", "amazon"},
				[]string{"0.0000000042609340000000000000", "7.142857142857135e+22", "304352428571428", "amazon"},
				[]string{"0.000000177541116000000000", "7.142857142857135e+22", "12681508285714300", "amazon"},
				[]string{"0.000000010652810000000000", "7.142857142857135e+22", "760914999999999", "amazon"},
				[]string{"0.000000710161439000000000", "7.142857142857135e+22", "50725817071428500", "amazon"},
				[]string{"0.000000017753976000000000", "7.142857142857135e+22", "1268141142857140", "amazon"},
				[]string{"0.000000567962096000000000", "7.142857142857135e+22", "40568721142857100", "amazon"},
				[]string{"0.000000177485776000000000", "7.142857142857135e+22", "12677555428571400", "amazon"},
				[]string{"0.000000177567939000000000", "7.142857142857135e+22", "12683424214285700", "amazon"},
				[]string{"0.000000177477282000000000", "7.142857142857135e+22", "12676948714285700", "amazon"},
				[]string{"0.000003551314066000000000", "7.142857142857135e+22", "253665290428571000", "amazon"},
				[]string{"0.000000035507717000000000", "7.142857142857135e+22", "2536265500000000", "amazon"},
				[]string{"0.000007101000823000000000", "7.142857142857135e+22", "507214344499999000", "amazon"},
				[]string{"0.000000355093693000000000", "7.142857142857135e+22", "25363835214285700", "amazon"},
				[]string{"0.000000177560352000000000", "7.142857142857135e+22", "12682882285714300", "amazon"},
				[]string{"0.000000177562333000000000", "7.142857142857135e+22", "12683023785714300", "amazon"},
				[]string{"0.000000177548374000000000", "7.142857142857135e+22", "12682026714285700", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000008345710692000000000", "7.142857142857135e+22", "596122192285714000", "amazon"},
				[]string{"0.000000177551253000000000", "7.142857142857135e+22", "12682232357142800", "amazon"},
				[]string{"0.0000000015978560000000000000", "7.142857142857135e+22", "114132571428571", "amazon"},
				[]string{"0.000000177564599000000000", "7.142857142857135e+22", "12683185642857100", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000000355065957000000000", "7.142857142857135e+22", "25361854071428500", "amazon"},
				[]string{"0.0000000035511690000000000000", "7.142857142857135e+22", "253654928571428", "amazon"},
				[]string{"0.000006030066520000000000", "7.142857142857135e+22", "430719037142857000", "amazon"},
				[]string{"0.000000177575222000000000", "7.142857142857135e+22", "12683944428571400", "amazon"},
				[]string{"0.000000160954181000000000", "7.142857142857135e+22", "11496727214285700", "amazon"},
				[]string{"0.000000177550884000000000", "7.142857142857135e+22", "12682206000000000", "amazon"},
				[]string{"0.000000177521945000000000", "7.142857142857135e+22", "12680138928571400", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000000177547181000000000", "7.142857142857135e+22", "12681941500000000", "amazon"},
				[]string{"0.000001775831065000000000", "7.142857142857135e+22", "126845076071428000", "amazon"},
				[]string{"0.000001953305464000000000", "7.142857142857135e+22", "139521818857143000", "amazon"},
				[]string{"0.000000177564194000000000", "7.142857142857135e+22", "12683156714285700", "amazon"},
				[]string{"0.000000266307436000000000", "7.142857142857135e+22", "19021959714285700", "amazon"},
				[]string{"0.000001598159016000000000", "7.142857142857135e+22", "114154215428571000", "amazon"},
				[]string{"0.000000376705811000000000", "7.142857142857135e+22", "26907557928571400", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000000177564599000000000", "7.142857142857135e+22", "12683185642857100", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.000001775422320000000000", "7.142857142857135e+22", "126815880000000000", "amazon"},
				[]string{"0.000000071026281000000000", "7.142857142857135e+22", "5073305785714280", "amazon"},
				[]string{"0.000003684823820000000000", "7.142857142857135e+22", "263201701428571000", "amazon"},
				[]string{"0.000000071024933000000000", "7.142857142857135e+22", "5073209499999990", "amazon"},
				[]string{"0.000000532654788000000000", "7.142857142857135e+22", "38046770571428500", "amazon"},
				[]string{"0.0000000017753990000000000000", "7.142857142857135e+22", "126814214285714", "amazon"},
				[]string{"0.000001171900828000000000", "7.142857142857135e+22", "83707201999999900", "amazon"},
				[]string{"0.000021301957490000000000", "7.142857142857135e+22", "1521568392142860000", "amazon"},
				[]string{"0.000001242748035000000000", "7.142857142857135e+22", "88767716785714200", "amazon"},
				[]string{"0.000000035506959000000000", "7.142857142857135e+22", "2536211357142850", "amazon"},
				[]string{"0.000001775649726000000000", "7.142857142857135e+22", "126832123285714000", "amazon"},
				[]string{"0.000000152246938000000000", "7.142857142857135e+22", "10874781285714300", "amazon"},
				[]string{"0.000096560069281000000000", "7.142857142857135e+22", "6897147805785710000", "amazon"},
				[]string{"0.000001598029817000000000", "7.142857142857135e+22", "114144986928571000", "amazon"},
				[]string{"0.0000000053265710000000000000", "7.142857142857135e+22", "380469357142857", "amazon"},
				[]string{"0.000008878623407000000000", "7.142857142857135e+22", "634187386214285000", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000001774279961000000000", "7.142857142857135e+22", "126734282928571000", "amazon"},
				[]string{"0.000000014913269000000000", "7.142857142857135e+22", "1065233500000000", "amazon"},
				[]string{"0.000000177556141000000000", "7.142857142857135e+22", "12682581500000000", "amazon"},
				[]string{"0.000000010652810000000000", "7.142857142857135e+22", "760914999999999", "amazon"},
				[]string{"0.000000053261987000000000", "7.142857142857135e+22", "3804427642857140", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000002165957781000000000", "7.142857142857135e+22", "154711270071428000", "amazon"},
				[]string{"0.000000012250185000000000", "7.142857142857135e+22", "875013214285713", "amazon"},
				[]string{"0.000001775588685000000000", "7.142857142857135e+22", "126827763214286000", "amazon"},
				[]string{"0.000000177574041000000000", "7.142857142857135e+22", "12683860071428600", "amazon"},
				[]string{"0.000000019526794000000000", "7.142857142857135e+22", "1394771000000000", "amazon"},
				[]string{"0.000000355103192000000000", "7.142857142857135e+22", "25364513714285700", "amazon"},
				[]string{"0.000003729197874000000000", "7.142857142857135e+22", "266371276714285000", "amazon"},
				[]string{"0.000003413603722000000000", "7.142857142857135e+22", "243828837285714000", "amazon"},
				[]string{"0.000000017748611000000000", "7.142857142857135e+22", "1267757928571430", "amazon"},
				[]string{"0.000000177558476000000000", "7.142857142857135e+22", "12682748285714300", "amazon"},
				[]string{"0.000000532725667000000000", "7.142857142857135e+22", "38051833357142800", "amazon"},
				[]string{"0.000000177552001000000000", "7.142857142857135e+22", "12682285785714300", "amazon"},
				[]string{"0.000003551025067000000000", "7.142857142857135e+22", "253644647642857000", "amazon"},
				[]string{"0.000000177532304000000000", "7.142857142857135e+22", "12680878857142800", "amazon"},
				[]string{"0.000025344883582000000000", "7.142857142857135e+22", "1810348827285710000", "amazon"},
				[]string{"0.0000000014378910000000000000", "7.142857142857135e+22", "102706500000000", "amazon"},
				[]string{"0.000000037282153000000000", "7.142857142857135e+22", "2663010928571430", "amazon"},
				[]string{"0.000000186414827000000000", "7.142857142857135e+22", "13315344785714300", "amazon"},
				[]string{"0.000000177495272000000000", "7.142857142857135e+22", "12678233714285700", "amazon"},
				[]string{"0.000000053262669000000000", "7.142857142857135e+22", "3804476357142850", "amazon"},
				[]string{"0.000013139578763000000000", "7.142857142857135e+22", "938541340214285000", "amazon"},
				[]string{"0.000000177567574000000000", "7.142857142857135e+22", "12683398142857100", "amazon"},
				[]string{"0.000005716905202000000000", "7.142857142857135e+22", "408350371571428000", "amazon"},
				[]string{"0.000000020704949000000000", "7.142857142857135e+22", "1478924928571430", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000004438861469000000000", "7.142857142857135e+22", "317061533500000000", "amazon"},
				[]string{"0.000000034289243000000000", "7.142857142857135e+22", "2449231642857140", "amazon"},
				[]string{"0.000000134172724000000000", "7.142857142857135e+22", "9583765999999990", "amazon"},
				[]string{"0.000000177550884000000000", "7.142857142857135e+22", "12682206000000000", "amazon"},
				[]string{"0.000000177563476000000000", "7.142857142857135e+22", "12683105428571400", "amazon"},
				[]string{"0.00062833116068700000", "7.142857142857135e+22", "44880797191928500000", "amazon"},
				[]string{"0.000007103234045000000000", "7.142857142857135e+22", "507373860357142000", "amazon"},
				[]string{"0.000000390548279000000000", "7.142857142857135e+22", "27896305642857100", "amazon"},
				[]string{"0.000000337306682000000000", "7.142857142857135e+22", "24093334428571400", "amazon"},
				[]string{"0.000000264123388000000000", "7.142857142857135e+22", "18865956285714300", "amazon"},
				[]string{"0.000000177561875000000000", "7.142857142857135e+22", "12682991071428600", "amazon"},
				[]string{"0.000002067752661000000000", "7.142857142857135e+22", "147696618642857000", "amazon"},
				[]string{"0.000000177573620000000000", "7.142857142857135e+22", "12683830000000000", "amazon"},
				[]string{"0.000000177465296000000000", "7.142857142857135e+22", "12676092571428600", "amazon"},
				[]string{"0.000001420407076000000000", "7.142857142857135e+22", "101457648285714000", "amazon"},
				[]string{"0.000001420153749000000000", "7.142857142857135e+22", "101439553500000000", "amazon"},
				[]string{"0.000000887915532000000000", "7.142857142857135e+22", "63422537999999900", "amazon"},
				[]string{"0.000000040345179000000000", "7.142857142857135e+22", "2881798500000000", "amazon"},
				[]string{"0.000000355106709000000000", "7.142857142857135e+22", "25364764928571400", "amazon"},
				[]string{"0.000000177563476000000000", "7.142857142857135e+22", "12683105428571400", "amazon"},
				[]string{"0.000001775407718000000000", "7.142857142857135e+22", "126814837000000000", "amazon"},
				[]string{"0.000001243015344000000000", "7.142857142857135e+22", "88786810285714200", "amazon"},
				[]string{"0.000000177552375000000000", "7.142857142857135e+22", "12682312500000000", "amazon"},
				[]string{"0.000000221084038000000000", "7.142857142857135e+22", "15791717000000000", "amazon"},
				[]string{"0.000000354955976000000000", "7.142857142857135e+22", "25353998285714300", "amazon"},
				[]string{"0.000000023794477000000000", "7.142857142857135e+22", "1699605500000000", "amazon"},
				[]string{"0.000002485790624000000000", "7.142857142857135e+22", "177556473142857000", "amazon"},
				[]string{"0.000000033733900000000000", "7.142857142857135e+22", "2409564285714280", "amazon"},
				[]string{"0.000042836974258000000000", "7.142857142857135e+22", "3059783875571430000", "amazon"},
				[]string{"0.000000088778758000000000", "7.142857142857135e+22", "6341339857142850", "amazon"},
				[]string{"0.000000195320614000000000", "7.142857142857135e+22", "13951472428571400", "amazon"},
				[]string{"0.000000177551253000000000", "7.142857142857135e+22", "12682232357142800", "amazon"},
				[]string{"0.000000177566079000000000", "7.142857142857135e+22", "12683291357142800", "amazon"},
				[]string{"0.000001219160408000000000", "7.142857142857135e+22", "87082886285714200", "amazon"},
				[]string{"0.000007099662785000000000", "7.142857142857135e+22", "507118770357142000", "amazon"},
				[]string{"0.000000177567574000000000", "7.142857142857135e+22", "12683398142857100", "amazon"},
				[]string{"0.000000177553354000000000", "7.142857142857135e+22", "12682382428571400", "amazon"},
				[]string{"0.0000000083443290000000000000", "7.142857142857135e+22", "596023499999999", "amazon"},
				[]string{"0.000000017757322000000000", "7.142857142857135e+22", "1268380142857140", "amazon"},
				[]string{"0.000000994298786000000000", "7.142857142857135e+22", "71021341857142800", "amazon"},
				[]string{"0.000000022374130000000000", "7.142857142857135e+22", "1598152142857140", "amazon"},
				[]string{"0.000001988640376000000000", "7.142857142857135e+22", "142045741142857000", "amazon"},
				[]string{"0.000001775122906000000000", "7.142857142857135e+22", "126794493285714000", "amazon"},
				[]string{"0.000000816833353000000000", "7.142857142857135e+22", "58345239499999900", "amazon"},
				[]string{"0.000000497111886000000000", "7.142857142857135e+22", "35507991857142800", "amazon"},
				[]string{"0.000011110982479000000000", "7.142857142857135e+22", "793641605642856000", "amazon"},
				[]string{"0.000000177546846000000000", "7.142857142857135e+22", "12681917571428600", "amazon"},
				[]string{"0.000000022465002000000000", "7.142857142857135e+22", "1604643000000000", "amazon"},
				[]string{"0.000001597863638000000000", "7.142857142857135e+22", "114133117000000000", "amazon"},
				[]string{"0.000000976512529000000000", "7.142857142857135e+22", "69750894928571300", "amazon"},
				[]string{"0.000000177563476000000000", "7.142857142857135e+22", "12683105428571400", "amazon"},
				[]string{"0.000000177573620000000000", "7.142857142857135e+22", "12683830000000000", "amazon"},
				[]string{"0.000000514875672000000000", "7.142857142857135e+22", "36776833714285700", "amazon"},
				[]string{"0.000000177553706000000000", "7.142857142857135e+22", "12682407571428600", "amazon"},
				[]string{"0.000001935163447000000000", "7.142857142857135e+22", "138225960500000000", "amazon"},
				[]string{"0.000000344982304000000000", "7.142857142857135e+22", "24641593142857100", "amazon"},
				[]string{"0.000001775668362000000000", "7.142857142857135e+22", "126833454428571000", "amazon"},
				[]string{"0.000002026020723000000000", "7.142857142857135e+22", "144715765928571000", "amazon"},
			}

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			for _, v := range values[:10] {
				stakerProportion := v[0]
				tokensPerDay := v[1]
				expectedResult := v[2]

				query := `select amazon_staker_token_rewards(@stakerProportion, @tokensPerDay) as amt`

				var result string
				res := grm.Raw(query, sql.Named("stakerProportion", stakerProportion), sql.Named("tokensPerDay", tokensPerDay)).Scan(&result)
				assert.Nil(t, res.Error)

				// expected, _ := decimal.NewFromString(expectedResult)
				// actual, _ := decimal.NewFromString(result)

				assert.Equal(t, expectedResult, result)
			}
		})
		t.Run("Should call nile_staker_token_rewards", func(t *testing.T) {
			values := [][]string{
				[]string{"0.000000240375027", "71428571428571350000000", "17169644785714300"},
				[]string{"0.000000182660779", "71428571428571350000000", "13047198500000000"},
				[]string{"0.000000182637329", "71428571428571350000000", "13045523500000000"},
				[]string{"0.000003470116004", "71428571428571350000000", "247865428857143000"},
				[]string{"0.000021918909001", "71428571428571350000000", "1565636357214280000"},
				[]string{"0.000003653540054", "71428571428571350000000", "260967146714285000"},
				[]string{"0.000000913478881", "71428571428571350000000", "65248491499999900"},
				[]string{"0.000000013027298", "71428571428571350000000", "930521285714285"},
				[]string{"0.000002554296328", "71428571428571350000000", "182449737714286000"},
				[]string{"0.000001826748407", "71428571428571350000000", "130482029071428000"},
				[]string{"0.000001826999023", "71428571428571350000000", "130499930214286000"},
				[]string{"0.00000018267561", "71428571428571350000000", "13048257857142800"},
				[]string{"0.000000182685769", "71428571428571350000000", "13048983500000000"},
				[]string{"0.000002366274776", "71428571428571350000000", "169019626857143000"},
				[]string{"0.00000164380537", "71428571428571350000000", "117414669285714000"},
				[]string{"0.000000370168897", "71428571428571350000000", "26440635500000000"},
				[]string{"0.000000182691271", "71428571428571350000000", "13049376500000000"},
				[]string{"0.000000365323009", "71428571428571350000000", "26094500642857100"},
				[]string{"0.000000182677002", "71428571428571350000000", "13048357285714300"},
				[]string{"0.000000182702737", "71428571428571350000000", "13050195500000000"},
				[]string{"0.000000182677002", "71428571428571350000000", "13048357285714300"},
				[]string{"0.000000018269785", "71428571428571350000000", "1304984642857140"},
				[]string{"0.000000182681938", "71428571428571350000000", "13048709857142800"},
				[]string{"0.000001987375845", "71428571428571350000000", "141955417500000000"},
				[]string{"0.000000042012909", "71428571428571350000000", "3000922071428570"},
				[]string{"0.000000730597415", "71428571428571350000000", "52185529642857100"},
				[]string{"0.000000182677002", "71428571428571350000000", "13048357285714300"},
				[]string{"0.000000039457125", "71428571428571350000000", "2818366071428570"},
				[]string{"0.000000365369184", "71428571428571350000000", "26097798857142800"},
				[]string{"0.000000182677726", "71428571428571350000000", "13048409000000000"},
				[]string{"0.000000310572503", "71428571428571350000000", "22183750214285700"},
				[]string{"0.000004226908614", "71428571428571350000000", "301922043857143000"},
				[]string{"0.000000365417168", "71428571428571350000000", "26101226285714300"},
				[]string{"0.000000177185592", "71428571428571350000000", "12656113714285700"},
				[]string{"0.000001643917568", "71428571428571350000000", "117422683428571000"},
				[]string{"0.00000018267416", "71428571428571350000000", "13048154285714300"},
				[]string{"0.000002740461681", "71428571428571350000000", "195747262928571000"},
				[]string{"0.000000002557447", "71428571428571350000000", "182674785714286"},
				[]string{"0.000001826557", "71428571428571350000000", "130468357142857000"},
				[]string{"0.000000164389211", "71428571428571350000000", "11742086500000000"},
				[]string{"0.000002739983387", "71428571428571350000000", "195713099071428000"},
				[]string{"0.000000036533111", "71428571428571350000000", "2609507928571430"},
				[]string{"0.000000182671879", "71428571428571350000000", "13047991357142800"},
				[]string{"0.000000091309387", "71428571428571350000000", "6522099071428560"},
				[]string{"0.000000182670306", "71428571428571350000000", "13047879000000000"},
				[]string{"0.000007305801647", "71428571428571350000000", "521842974785714000"},
				[]string{"0.000000182690094", "71428571428571350000000", "13049292428571400"},
				[]string{"0.000004749759756", "71428571428571350000000", "339268554000000000"},
				[]string{"0.000000190360649", "71428571428571350000000", "13597189214285700"},
				[]string{"0.000000182672242", "71428571428571350000000", "13048017285714300"},
				[]string{"0.000000365328113", "71428571428571350000000", "26094865214285700"},
				[]string{"0.000002739922568", "71428571428571350000000", "195708754857143000"},
				[]string{"0.000000182660056", "71428571428571350000000", "13047146857142800"},
				[]string{"0.00000006211612", "71428571428571350000000", "4436865714285710"},
				[]string{"0.000000049568549", "71428571428571350000000", "3540610642857140"},
				[]string{"0.000000913489267", "71428571428571350000000", "65249233357142800"},
				[]string{"0.000000182580477", "71428571428571350000000", "13041462642857100"},
				[]string{"0.000001643953541", "71428571428571350000000", "117425252928571000"},
				[]string{"0.000000182670651", "71428571428571350000000", "13047903642857100"},
				[]string{"0.000000018269744", "71428571428571350000000", "1304981714285710"},
				[]string{"0.000000367521622", "71428571428571350000000", "26251544428571400"},
				[]string{"0.000000007306545", "71428571428571350000000", "521896071428571"},
				[]string{"0.000000182670306", "71428571428571350000000", "13047879000000000"},
				[]string{"0.000000018269828", "71428571428571350000000", "1304987714285710"},
				[]string{"0.000000164413436", "71428571428571350000000", "11743816857142800"},
				[]string{"0.000000027764809", "71428571428571350000000", "1983200642857140"},
				[]string{"0.000000401954789", "71428571428571350000000", "28711056357142800"},
				[]string{"0.000000124233734", "71428571428571350000000", "8873838142857130"},
				[]string{"0.000000482267287", "71428571428571350000000", "34447663357142800"},
				[]string{"0.000000730719481", "71428571428571350000000", "52194248642857100"},
				[]string{"0.000000182688572", "71428571428571350000000", "13049183714285700"},
				[]string{"0.000000913289559", "71428571428571350000000", "65234968499999900"},
				[]string{"0.000001826644113", "71428571428571350000000", "130474579500000000"},
				[]string{"0.000000182671879", "71428571428571350000000", "13047991357142800"},
				[]string{"0.000000182662499", "71428571428571350000000", "13047321357142800"},
				[]string{"0.000000365352705", "71428571428571350000000", "26096621785714300"},
				[]string{"0.000000182705292", "71428571428571350000000", "13050378000000000"},
				[]string{"0.00000018267561", "71428571428571350000000", "13048257857142800"},
				[]string{"0.000000363500629", "71428571428571350000000", "25964330642857100"},
				[]string{"0.000000182664822", "71428571428571350000000", "13047487285714300"},
				[]string{"0.000001004711624", "71428571428571350000000", "71765115999999900"},
				[]string{"0.000000182685769", "71428571428571350000000", "13048983500000000"},
				[]string{"0.000000091335153", "71428571428571350000000", "6523939499999990"},
				[]string{"0.000000200927655", "71428571428571350000000", "14351975357142800"},
				[]string{"0.00000018267561", "71428571428571350000000", "13048257857142800"},
				[]string{"0.000000182698286", "71428571428571350000000", "13049877571428600"},
				[]string{"0.000001826621546", "71428571428571350000000", "130472967571428000"},
				[]string{"0.000001644257716", "71428571428571350000000", "117446979714286000"},
				[]string{"0.000000730781207", "71428571428571350000000", "52198657642857100"},
				[]string{"0.000002369608877", "71428571428571350000000", "169257776928571000"},
				[]string{"0.000000182685769", "71428571428571350000000", "13048983500000000"},
				[]string{"0.000005845092031", "71428571428571350000000", "417506573642857000"},
				[]string{"0.000000365351989", "71428571428571350000000", "26096570642857100"},
				[]string{"0.000001826900944", "71428571428571350000000", "130492924571428000"},
				[]string{"0.000000182684202", "71428571428571350000000", "13048871571428600"},
				[]string{"0.00000018267987", "71428571428571350000000", "13048562142857100"},
				[]string{"0.000000009133515", "71428571428571350000000", "652393928571428"},
				[]string{"0.000000182698286", "71428571428571350000000", "13049877571428600"},
				[]string{"0.00000018267561", "71428571428571350000000", "13048257857142800"},
				[]string{"0.00000054801092", "71428571428571350000000", "39143637142857100"},
			}

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			for _, v := range values {
				stakerProportion := v[0]
				tokensPerDay := v[1]
				expectedResult := v[2]

				query := `select nile_staker_token_rewards(@stakerProportion, @tokensPerDay) as amt`

				var result string
				res := grm.Raw(query, sql.Named("stakerProportion", stakerProportion), sql.Named("tokensPerDay", tokensPerDay)).Scan(&result)
				assert.Nil(t, res.Error)

				//expected, _ := decimal.NewFromString(expectedResult)
				//actual, _ := decimal.NewFromString(result)

				assert.Equal(t, expectedResult, result, "stakerProportion: %s, tokensPerDay: %s", stakerProportion, tokensPerDay)
			}
		})
		t.Run("Should call staker_token_rewards", func(t *testing.T) {
			values := [][]string{
				[]string{"0.051496894097124", "392857142857142857", "20230922681012999"},
				[]string{"0.279567696428409", "392857142857142857", "109830166454017821"},
				[]string{"0.65685317576837", "392857142857142857", "258049461909002499"},
				[]string{"0.011884541745805", "392857142857142857", "4668927114423392"},
				[]string{"0.00019769196029", "392857142857142857", "77664698685357"},
				[]string{"0.051496894097124", "392857142857142857", "20230922681012999"},
				[]string{"0.279567696428409", "392857142857142857", "109830166454017821"},
				[]string{"0.65685317576837", "392857142857142857", "258049461909002499"},
				[]string{"0.011884541745805", "392857142857142857", "4668927114423392"},
				[]string{"0.00019769196029", "392857142857142857", "77664698685357"},
				[]string{"1", "357142857142857142857", "357142857142857142857"},
				[]string{"1", "357142857142857142857", "357142857142857142857"},
				[]string{"0.051496894097124", "14428571428571428571", "743026614829931999"},
				[]string{"0.279567696428409", "14428571428571428571", "4033762477038472714"},
				[]string{"0.65685317576837", "14428571428571428571", "9477452964657909999"},
				[]string{"0.011884541745805", "14428571428571428571", "171476959475186428"},
				[]string{"0.00019769196029", "14428571428571428571", "2852412569898571"},
				[]string{"0.051496894097124", "14428571428571428571", "743026614829931999"},
				[]string{"0.279567696428409", "14428571428571428571", "4033762477038472714"},
				[]string{"0.65685317576837", "14428571428571428571", "9477452964657909999"},
				[]string{"0.011884541745805", "14428571428571428571", "171476959475186428"},
				[]string{"0.00019769196029", "14428571428571428571", "2852412569898571"},
			}

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			for _, v := range values {
				stakerProportion := v[0]
				tokensPerDay := v[1]
				expectedResult := v[2]

				query := `select staker_token_rewards(@stakerProportion, @tokensPerDay) as amt`

				var result string
				res := grm.Raw(query, sql.Named("stakerProportion", stakerProportion), sql.Named("tokensPerDay", tokensPerDay)).Scan(&result)
				assert.Nil(t, res.Error)

				//expected, _ := decimal.NewFromString(expectedResult)
				//actual, _ := decimal.NewFromString(result)
				goRes, _ := numbers.StakerTokenRewards(stakerProportion, tokensPerDay)

				assert.Equal(t, expectedResult, result, "stakerProportion: %s, tokensPerDay: %s go result: %s", stakerProportion, tokensPerDay, goRes)
			}
		})
		t.Run("Should call amazon_operator_token_rewards", func(t *testing.T) {
			query := `select amazon_operator_token_rewards('100') as amt`

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			var result string
			res := grm.Raw(query).Scan(&result)
			assert.Nil(t, res.Error)

			assert.Equal(t, "10", result)
		})
		t.Run("Should call nile_operator_token_rewards", func(t *testing.T) {
			values := [][]string{[]string{"17169644785714300", "1716964478571430"},
				[]string{"13047198500000000", "1304719850000000"},
				[]string{"13045523500000000", "1304552350000000"},
				[]string{"247865428857143000", "24786542885714300"},
				[]string{"1565636357214280000", "156563635721428000"},
				[]string{"260967146714285000", "26096714671428500"},
				[]string{"65248491499999900", "6524849149999990"},
				[]string{"930521285714285", "93052128571429"},
				[]string{"182449737714286000", "18244973771428600"},
				[]string{"130482029071428000", "13048202907142800"},
				[]string{"130499930214286000", "13049993021428600"},
				[]string{"13048257857142800", "1304825785714280"},
				[]string{"13048983500000000", "1304898350000000"},
				[]string{"169019626857143000", "16901962685714300"},
				[]string{"117414669285714000", "11741466928571400"},
				[]string{"26440635500000000", "2644063550000000"},
				[]string{"13049376500000000", "1304937650000000"},
				[]string{"26094500642857100", "2609450064285710"},
				[]string{"13048357285714300", "1304835728571430"},
				[]string{"13050195500000000", "1305019550000000"},
				[]string{"13048357285714300", "1304835728571430"},
				[]string{"1304984642857140", "130498464285714"},
				[]string{"13048709857142800", "1304870985714280"},
				[]string{"141955417500000000", "14195541750000000"},
				[]string{"3000922071428570", "300092207142857"},
				[]string{"52185529642857100", "5218552964285710"},
				[]string{"13048357285714300", "1304835728571430"},
				[]string{"2818366071428570", "281836607142857"},
				[]string{"26097798857142800", "2609779885714280"},
				[]string{"13048409000000000", "1304840900000000"},
				[]string{"22183750214285700", "2218375021428570"},
				[]string{"301922043857143000", "30192204385714300"},
				[]string{"26101226285714300", "2610122628571430"},
				[]string{"12656113714285700", "1265611371428570"},
				[]string{"117422683428571000", "11742268342857100"},
				[]string{"13048154285714300", "1304815428571430"},
				[]string{"195747262928571000", "19574726292857100"},
				[]string{"182674785714286", "18267478571429"},
				[]string{"130468357142857000", "13046835714285700"},
				[]string{"11742086500000000", "1174208650000000"},
				[]string{"195713099071428000", "19571309907142800"},
				[]string{"2609507928571430", "260950792857143"},
				[]string{"13047991357142800", "1304799135714280"},
				[]string{"6522099071428560", "652209907142856"},
				[]string{"13047879000000000", "1304787900000000"},
				[]string{"521842974785714000", "52184297478571400"},
				[]string{"13049292428571400", "1304929242857140"},
				[]string{"339268554000000000", "33926855400000000"},
				[]string{"13597189214285700", "1359718921428570"},
				[]string{"13048017285714300", "1304801728571430"},
				[]string{"26094865214285700", "2609486521428570"},
				[]string{"195708754857143000", "19570875485714300"},
				[]string{"13047146857142800", "1304714685714280"},
				[]string{"4436865714285710", "443686571428571"},
				[]string{"3540610642857140", "354061064285714"},
				[]string{"65249233357142800", "6524923335714280"},
				[]string{"13041462642857100", "1304146264285710"},
				[]string{"117425252928571000", "11742525292857100"},
				[]string{"13047903642857100", "1304790364285710"},
				[]string{"1304981714285710", "130498171428571"},
				[]string{"26251544428571400", "2625154442857140"},
				[]string{"521896071428571", "52189607142857"},
				[]string{"13047879000000000", "1304787900000000"},
				[]string{"1304987714285710", "130498771428571"},
				[]string{"11743816857142800", "1174381685714280"},
				[]string{"1983200642857140", "198320064285714"},
				[]string{"28711056357142800", "2871105635714280"},
				[]string{"8873838142857130", "887383814285713"},
				[]string{"34447663357142800", "3444766335714280"},
				[]string{"52194248642857100", "5219424864285710"},
				[]string{"13049183714285700", "1304918371428570"},
				[]string{"65234968499999900", "6523496849999990"},
				[]string{"130474579500000000", "13047457950000000"},
				[]string{"13047991357142800", "1304799135714280"},
				[]string{"13047321357142800", "1304732135714280"},
				[]string{"26096621785714300", "2609662178571430"},
				[]string{"13050378000000000", "1305037800000000"},
				[]string{"13048257857142800", "1304825785714280"},
				[]string{"25964330642857100", "2596433064285710"},
				[]string{"13047487285714300", "1304748728571430"},
				[]string{"71765115999999900", "7176511599999990"},
				[]string{"13048983500000000", "1304898350000000"},
				[]string{"6523939499999990", "652393949999999"},
				[]string{"14351975357142800", "1435197535714280"},
				[]string{"13048257857142800", "1304825785714280"},
				[]string{"13049877571428600", "1304987757142860"},
				[]string{"130472967571428000", "13047296757142800"},
				[]string{"117446979714286000", "11744697971428600"},
				[]string{"52198657642857100", "5219865764285710"},
				[]string{"169257776928571000", "16925777692857100"},
				[]string{"13048983500000000", "1304898350000000"},
				[]string{"417506573642857000", "41750657364285700"},
				[]string{"26096570642857100", "2609657064285710"},
				[]string{"130492924571428000", "13049292457142800"},
				[]string{"13048871571428600", "1304887157142860"},
				[]string{"13048562142857100", "1304856214285710"},
				[]string{"652393928571428", "65239392857143"},
				[]string{"13049877571428600", "1304987757142860"},
				[]string{"13048257857142800", "1304825785714280"},
				[]string{"39143637142857100", "3914363714285710"},
			}

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			for _, v := range values {
				totalStakerOperatorPayout := v[0]
				expectedResult := v[1]

				query := `select nile_operator_token_rewards(@totalStakerOperatorPayout) as amt`
				var result string
				res := grm.Raw(query, sql.Named("totalStakerOperatorPayout", totalStakerOperatorPayout)).Scan(&result)
				assert.Nil(t, res.Error)

				assert.Equal(t, expectedResult, result, "totalStakerOperatorPayout: %s", totalStakerOperatorPayout)
			}
		})
		t.Run("Should call big_gt", func(t *testing.T) {
			query := `select big_gt('100', '1') as gt`

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			var result string
			res := grm.Raw(query).Scan(&result)
			assert.Nil(t, res.Error)

			assert.Equal(t, "1", result)
		})
		t.Run("Should call numeric_multiply_c", func(t *testing.T) {
			query := `select numeric_multiply_c('100', '.1')`

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			var result string
			res := grm.Raw(query).Scan(&result)
			assert.Nil(t, res.Error)

			assert.Equal(t, "10.0", result)
		})
		t.Run("Should call sum_big_c", func(t *testing.T) {
			t.Skip("This function is actually an aggregate function")
			query := `select sum_big_c('100', '1')`

			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			var result string
			res := grm.Raw(query).Scan(&result)
			assert.Nil(t, res.Error)

			assert.Equal(t, "101", result)
		})
		t.Run("Should call sum_big_c", func(t *testing.T) {
			values := [][]string{
				[]string{"2586595906852124520000000000000000000", "78563914570073760561000000000000000000", "0.03292346010260200000"},
				[]string{"75370449903508156204000000000000000000", "78563914570073760561000000000000000000", "0.95935201696553300000"},
				[]string{"596939049887864861000000000000000000", "78563914570073760561000000000000000000", "0.00759813271976700000"},
				[]string{"9929709825614976000000000000000000", "78563914570073760561000000000000000000", "0.00012639021209600000"},
				[]string{"2586595906852124520000000000000000000", "78563914570073760561000000000000000000", "0.03292346010260200000"},
				[]string{"75370449903508156204000000000000000000", "78563914570073760561000000000000000000", "0.95935201696553300000"},
				[]string{"596939049887864861000000000000000000", "78563914570073760561000000000000000000", "0.00759813271976700000"},
				[]string{"9929709825614976000000000000000000", "78563914570073760561000000000000000000", "0.00012639021209600000"},
				[]string{"2000000000000000000000000000000000000000", "2000000000000000000000000000000000000000", "1.00000000000000000000"},
				[]string{"2000000000000000000000000000000000000000", "2000000000000000000000000000000000000000", "1.00000000000000000000"},
			}
			s := NewSqlite(&SqliteConfig{
				Path:           SqliteInMemoryPath,
				ExtensionsPath: []string{tests.GetSqliteExtensionsPath()},
			}, l)
			grm, err := NewGormSqliteFromSqlite(s)
			assert.Nil(t, err)

			for _, v := range values {
				stakerWeight := v[0]
				totalWeight := v[1]
				stakerProportion := v[2]

				query := `select calculate_staker_proportion(@stakerWeight, @totalWeight)`

				var result string
				res := grm.Raw(query, sql.Named("stakerWeight", stakerWeight), sql.Named("totalWeight", totalWeight)).Scan(&result)
				assert.Nil(t, res.Error)

				resultDecimal, _ := decimal.NewFromString(result)
				expectedDecimal, _ := decimal.NewFromString(stakerProportion)

				assert.Equal(t, resultDecimal.Equal(expectedDecimal), true)
			}
		})
	})
}
